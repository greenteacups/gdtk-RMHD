-- udf-source-template.lua
-- Lua template for the source terms of a Manufactured Solution.
--
-- PJ, 29-May-2011
-- RJG, 06-Jun-2014
--   Declared maths functions as local

local sin = math.sin
local cos = math.cos
local exp = math.exp
local pi = math.pi

function sourceTerms(t, cell)
   src = {}
   x = cell.x
   y = cell.y


fmass = (-0.1*pi*x*sin(3.9269908169872415*x*y) - 0.15*pi*sin(3.1415926535897932*y))*(-0.9*sin(1.5707963267948966*y) -0.02*cos(4.7123889803846899*x) + 0.02*cos(4.7123889803846899*x*y) + 0.9) + (-0.03*pi*x*sin(4.7123889803846899*x*y) - 0.45*pi*cos(1.5707963267948966*y))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) +1.0) + (-0.1*pi*y*sin(3.9269908169872415*x*y) + 0.075*pi*cos(2.3561944901923449*x))*(0.1*cos(5.235987755982989*x) +1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) + 1.0) + (0.166666666666667*pi*y*sin(5.235987755982989*x*y) - 0.166666666666667*pi*sin(5.235987755982989*x))*(0.1*sin(2.3561944901923449*x) +0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) + 1.0)



fxmom = -2.77777777777778*pi^2*x^2*cos(5.235987755982989*x*y) +0.15*pi^2*x*y*cos(4.7123889803846899*x*y) -3.7037037037037*pi^2*y^2*cos(5.235987755982989*x*y) + (-0.1*pi*x*sin(3.9269908169872415*x*y) - 0.15*pi*sin(3.1415926535897932*y))*(-0.9*sin(1.5707963267948966*y) -0.02*cos(4.7123889803846899*x) + 0.02*cos(4.7123889803846899*x*y) + 0.9)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) + 1.0) + (-0.03*pi*x*sin(4.7123889803846899*x*y) - 0.45*pi*cos(1.5707963267948966*y))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) +1.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) +1.0) + (0.166666666666667*pi*x*sin(5.235987755982989*x*y) -1.0*pi*sin(3.1415926535897932*y))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) +0.08*cos(3.9269908169872415*x*y) + 1.0)*(-0.9*sin(1.5707963267948966*y) - 0.02*cos(4.7123889803846899*x) +0.02*cos(4.7123889803846899*x*y) + 0.9) + (-28.7*pi*y*sin(3.9269908169872415*x*y) + 21.525*pi*cos(2.3561944901923449*x))*(25.0*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 10.0*cos(4.7123889803846899*x) + 350) + (-0.1*pi*y*sin(3.9269908169872415*x*y) + 0.075*pi*cos(2.3561944901923449*x))*(0.1*cos(5.235987755982989*x) +1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) + 1.0)^2 + (0.333333333333333*pi*y*sin(5.235987755982989*x*y) - 0.333333333333333*pi*sin(5.235987755982989*x))*(0.1*sin(2.3561944901923449*x) +0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) + 1.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) + 1.0) + (-18.75*pi*sin(2.3561944901923449*x)*sin(3.1415926535897932*y) + 15.0*pi*sin(4.7123889803846899*x))*(28.7*sin(2.3561944901923449*x)+ 43.05*cos(3.1415926535897932*y) + 22.96*cos(3.9269908169872415*x*y) + 287.0) + 0.1*pi*sin(4.7123889803846899*x*y) + 3.7037037037037*pi^2*cos(5.235987755982989*x) + 10.0*pi^2*cos(3.1415926535897932*y)



fymom = 0.6*pi^2*x^2*cos(4.7123889803846899*x*y) -0.925925925925926*pi^2*x*y*cos(5.235987755982989*x*y) +0.45*pi^2*y^2*cos(4.7123889803846899*x*y) + (-28.7*pi*x*sin(3.9269908169872415*x*y) - 43.05*pi*sin(3.1415926535897932*y))*(25.0*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 10.0*cos(4.7123889803846899*x) +350) + 0.81*(-0.1*pi*x*sin(3.9269908169872415*x*y) - 0.15*pi*sin(3.1415926535897932*y))*(-sin(1.5707963267948966*y) -0.0222222222222222*cos(4.7123889803846899*x) +0.0222222222222222*cos(4.7123889803846899*x*y) + 1)^2 +0.81*(-0.0666666666666667*pi*x*sin(4.7123889803846899*x*y)- pi*cos(1.5707963267948966*y))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) + 1.0)*(-sin(1.5707963267948966*y)- 0.0222222222222222*cos(4.7123889803846899*x) +0.0222222222222222*cos(4.7123889803846899*x*y) + 1) + (-0.1*pi*y*sin(3.9269908169872415*x*y) + 0.075*pi*cos(2.3561944901923449*x))*(-0.9*sin(1.5707963267948966*y) -0.02*cos(4.7123889803846899*x) + 0.02*cos(4.7123889803846899*x*y) + 0.9)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) + 1.0) + (-0.03*pi*y*sin(4.7123889803846899*x*y) + 0.03*pi*sin(4.7123889803846899*x))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) +1.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) +1.0) + (0.166666666666667*pi*y*sin(5.235987755982989*x*y) -0.166666666666667*pi*sin(5.235987755982989*x))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) +0.08*cos(3.9269908169872415*x*y) + 1.0)*(-0.9*sin(1.5707963267948966*y) - 0.02*cos(4.7123889803846899*x) +0.02*cos(4.7123889803846899*x*y) + 0.9) + 25.0*pi*(28.7*sin(2.3561944901923449*x) + 43.05*cos(3.1415926535897932*y) + 22.96*cos(3.9269908169872415*x*y) + 287.0)*cos(2.3561944901923449*x)*cos(3.1415926535897932*y) - 3.0*pi^2*sin(1.5707963267948966*y) - 0.555555555555556*pi*sin(5.235987755982989*x*y) - 0.45*pi^2*cos(4.7123889803846899*x)



fe = (-28.7*pi*x*sin(3.9269908169872415*x*y) - 43.05*pi*sin(3.1415926535897932*y))*(25.0*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 10.0*cos(4.7123889803846899*x) +350)*(-0.9*sin(1.5707963267948966*y) - 0.02*cos(4.7123889803846899*x) + 0.02*cos(4.7123889803846899*x*y) +0.9) + (-0.1*pi*x*sin(3.9269908169872415*x*y) - 0.15*pi*sin(3.1415926535897932*y))*(-0.9*sin(1.5707963267948966*y)- 0.02*cos(4.7123889803846899*x) + 0.02*cos(4.7123889803846899*x*y) + 0.9)*(0.405*(-sin(1.5707963267948966*y) - 0.0222222222222222*cos(4.7123889803846899*x) + 0.0222222222222222*cos(4.7123889803846899*x*y) + 1)^2 + (1.0/2.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) -0.1*cos(5.235987755982989*x*y) + 1.0)^2 + 17937.5*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 7175.0*cos(4.7123889803846899*x) + 251125.0) + (-0.03*pi*x*sin(4.7123889803846899*x*y) - 0.45*pi*cos(1.5707963267948966*y))*(25.0*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 10.0*cos(4.7123889803846899*x) + 350)*(28.7*sin(2.3561944901923449*x) + 43.05*cos(3.1415926535897932*y) +22.96*cos(3.9269908169872415*x*y) + 287.0) + (-0.03*pi*x*sin(4.7123889803846899*x*y) - 0.45*pi*cos(1.5707963267948966*y))*(0.1*sin(2.3561944901923449*x) +0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) + 1.0)*(0.405*(-sin(1.5707963267948966*y) - 0.0222222222222222*cos(4.7123889803846899*x) + 0.0222222222222222*cos(4.7123889803846899*x*y) + 1)^2 + (1.0/2.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) -0.1*cos(5.235987755982989*x*y) + 1.0)^2 + 17937.5*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 7175.0*cos(4.7123889803846899*x) + 251125.0) + (0.03*pi*x*sin(4.7123889803846899*x*y) + 0.45*pi*cos(1.5707963267948966*y))*(-0.4*pi*x*sin(4.7123889803846899*x*y) -1.11111111111111*pi*y*sin(5.235987755982989*x*y) +1.11111111111111*pi*sin(5.235987755982989*x) - 6.0*pi*cos(1.5707963267948966*y)) + (-0.166666666666667*pi*x*sin(5.235987755982989*x*y) + 1.0*pi*sin(3.1415926535897932*y))*(1.66666666666667*pi*x*sin(5.235987755982989*x*y) - 0.3*pi*y*sin(4.7123889803846899*x*y) + 0.3*pi*sin(4.7123889803846899*x) - 10.0*pi*sin(3.1415926535897932*y))+ (-28.7*pi*y*sin(3.9269908169872415*x*y) + 21.525*pi*cos(2.3561944901923449*x))*(25.0*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 10.0*cos(4.7123889803846899*x) +350)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) +1.0) + (-0.1*pi*y*sin(3.9269908169872415*x*y) + 0.075*pi*cos(2.3561944901923449*x))*(0.1*cos(5.235987755982989*x) +1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) + 1.0)*(0.405*(-sin(1.5707963267948966*y) -0.0222222222222222*cos(4.7123889803846899*x) +0.0222222222222222*cos(4.7123889803846899*x*y) + 1)^2 + (1.0/2.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) +1.0)^2 + 17937.5*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 7175.0*cos(4.7123889803846899*x) +251125.0) + (0.03*pi*y*sin(4.7123889803846899*x*y) - 0.03*pi*sin(4.7123889803846899*x))*(1.66666666666667*pi*x*sin(5.235987755982989*x*y) - 0.3*pi*y*sin(4.7123889803846899*x*y) + 0.3*pi*sin(4.7123889803846899*x) - 10.0*pi*sin(3.1415926535897932*y)) + (-0.166666666666667*pi*y*sin(5.235987755982989*x*y) + 0.166666666666667*pi*sin(5.235987755982989*x))*(0.2*pi*x*sin(4.7123889803846899*x*y) + 2.22222222222222*pi*y*sin(5.235987755982989*x*y) -2.22222222222222*pi*sin(5.235987755982989*x) + 3.0*pi*cos(1.5707963267948966*y)) + (0.166666666666667*pi*y*sin(5.235987755982989*x*y) - 0.166666666666667*pi*sin(5.235987755982989*x))*(25.0*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 10.0*cos(4.7123889803846899*x) +350)*(28.7*sin(2.3561944901923449*x) + 43.05*cos(3.1415926535897932*y) + 22.96*cos(3.9269908169872415*x*y) +287.0) + (0.166666666666667*pi*y*sin(5.235987755982989*x*y) - 0.166666666666667*pi*sin(5.235987755982989*x))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) +0.08*cos(3.9269908169872415*x*y) + 1.0)*(0.405*(-sin(1.5707963267948966*y) - 0.0222222222222222*cos(4.7123889803846899*x) + 0.0222222222222222*cos(4.7123889803846899*x*y) + 1)^2 + (1.0/2.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) -0.1*cos(5.235987755982989*x*y) + 1.0)^2 + 17937.5*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 7175.0*cos(4.7123889803846899*x) + 251125.0) + (-18.75*pi*sin(2.3561944901923449*x)*sin(3.1415926535897932*y) + 15.0*pi*sin(4.7123889803846899*x))*(28.7*sin(2.3561944901923449*x)+ 43.05*cos(3.1415926535897932*y) + 22.96*cos(3.9269908169872415*x*y) + 287.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) -0.1*cos(5.235987755982989*x*y) + 1.0) + (0.405*(-0.0666666666666667*pi*x*sin(4.7123889803846899*x*y) - pi*cos(1.5707963267948966*y))*(-sin(1.5707963267948966*y) -0.0222222222222222*cos(4.7123889803846899*x) +0.0222222222222222*cos(4.7123889803846899*x*y) + 1) + (1.0/2.0)*(0.333333333333333*pi*x*sin(5.235987755982989*x*y) -2.0*pi*sin(3.1415926535897932*y))*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) -0.1*cos(5.235987755982989*x*y) + 1.0) + 17937.5*pi*cos(2.3561944901923449*x)*cos(3.1415926535897932*y))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) +0.08*cos(3.9269908169872415*x*y) + 1.0)*(-0.9*sin(1.5707963267948966*y) - 0.02*cos(4.7123889803846899*x) +0.02*cos(4.7123889803846899*x*y) + 0.9) + (0.405*(-0.0666666666666667*pi*y*sin(4.7123889803846899*x*y) +0.0666666666666667*pi*sin(4.7123889803846899*x))*(-sin(1.5707963267948966*y) - 0.0222222222222222*cos(4.7123889803846899*x) + 0.0222222222222222*cos(4.7123889803846899*x*y) + 1) + (1.0/2.0)*(0.333333333333333*pi*y*sin(5.235987755982989*x*y) -0.333333333333333*pi*sin(5.235987755982989*x))*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) -0.1*cos(5.235987755982989*x*y) + 1.0) - 13453.125*pi*sin(2.3561944901923449*x)*sin(3.1415926535897932*y) + 10762.5*pi*sin(4.7123889803846899*x))*(0.1*sin(2.3561944901923449*x) + 0.15*cos(3.1415926535897932*y) + 0.08*cos(3.9269908169872415*x*y) + 1.0)*(0.1*cos(5.235987755982989*x) + 1.0*cos(3.1415926535897932*y) - 0.1*cos(5.235987755982989*x*y) + 1.0) + (-0.6*pi^2*x^2*cos(4.7123889803846899*x*y) - 1.85185185185185*pi^2*x*y*cos(5.235987755982989*x*y) + 3.0*pi^2*sin(1.5707963267948966*y) - 1.11111111111111*pi*sin(5.235987755982989*x*y))*(0.9*sin(1.5707963267948966*y) + 0.02*cos(4.7123889803846899*x)- 0.02*cos(4.7123889803846899*x*y) - 0.9) + (2.77777777777778*pi^2*x^2*cos(5.235987755982989*x*y) -0.45*pi^2*x*y*cos(4.7123889803846899*x*y) - 0.3*pi*sin(4.7123889803846899*x*y) - 10.0*pi^2*cos(3.1415926535897932*y))*(-0.1*cos(5.235987755982989*x) - 1.0*cos(3.1415926535897932*y) + 0.1*cos(5.235987755982989*x*y) -1.0) + (0.3*pi^2*x*y*cos(4.7123889803846899*x*y) +3.7037037037037*pi^2*y^2*cos(5.235987755982989*x*y) + 0.2*pi*sin(4.7123889803846899*x*y) - 3.7037037037037*pi^2*cos(5.235987755982989*x))*(-0.1*cos(5.235987755982989*x) -1.0*cos(3.1415926535897932*y) + 0.1*cos(5.235987755982989*x*y) - 1.0) + (2.77777777777778*pi^2*x*y*cos(5.235987755982989*x*y) - 0.45*pi^2*y^2*cos(4.7123889803846899*x*y) + 1.66666666666667*pi*sin(5.235987755982989*x*y) + 0.45*pi^2*cos(4.7123889803846899*x))*(0.9*sin(1.5707963267948966*y) + 0.02*cos(4.7123889803846899*x) - 0.02*cos(4.7123889803846899*x*y) -0.9) + 25.0*pi*(28.7*sin(2.3561944901923449*x) + 43.05*cos(3.1415926535897932*y) + 22.96*cos(3.9269908169872415*x*y) + 287.0)*(-0.9*sin(1.5707963267948966*y) - 0.02*cos(4.7123889803846899*x) + 0.02*cos(4.7123889803846899*x*y) +0.9)*cos(2.3561944901923449*x)*cos(3.1415926535897932*y) +390625.0*pi^2*sin(3.1415926535897932*y)*cos(2.3561944901923449*x) - 225000.0*pi^2*cos(4.7123889803846899*x)



   src.mass = fmass
   src.momentum_x = fxmom
   src.momentum_y = fymom
   src.momentum_z = 0.0
   src.total_energy = fe
   return src
end
